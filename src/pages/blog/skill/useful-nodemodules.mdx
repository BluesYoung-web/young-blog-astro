---
title: å®ç”¨çš„ node ä¾èµ–åŒ…
description: å®ç”¨çš„ node ä¾èµ–åŒ…
date: 2022-11-13 17:20:00
---
import Alert from '@/components/post/alert.astro'

[[toc]]

## è‡ªå·±é€ çš„ä¸€äº›å¸¸ç”¨çš„è½®å­

### `@bluesyoung/rpc`

ğŸŒŸ åŸºäº `postMessage` + `MessageChannel`

ğŸŒŸ å¯ç”¨äº `window.open` æ‰“å¼€çš„é¡µé¢åŠ `iframe` åµŒå¥—çš„å­é¡µé¢ä¸çˆ¶é¡µé¢ä¹‹é—´çš„é€šä¿¡(è¿œç¨‹å‡½æ•°è°ƒç”¨)

ğŸŒŸ æ— è§†è·¨åŸŸé™åˆ¶ï¼Œæ‹¥æœ‰å®‰å…¨é™åˆ¶ï¼Œé˜»éš”æ¶æ„æ¶ˆæ¯

**ğŸŒŸ `100% TypeScript`ï¼Œæ‹¥æœ‰è¿‘ä¹å®Œç¾çš„ç±»å‹æç¤º**

ğŸŒŸ `esm` | `cjs` | `umd`ï¼Œå„ç§ç¯å¢ƒä¸€åº”ä¿±å…¨

ğŸŒŸ `IOC` é€šä¿¡ä¸è°ƒç”¨è§£è€¦


### `@bluesyoung/unplugin-json-conf`

ğŸŒŸ åœ¨è¿è¡Œ/æ‰“åŒ…è¿‡ç¨‹ä¸­ï¼ŒåŠ è½½æŒ‡å®šä½ç½®çš„ `JSON` æ–‡ä»¶çš„å†…å®¹ä½œä¸ºè™šæ‹Ÿæ¨¡å—çš„é»˜è®¤å¯¼å‡ºå†…å®¹

### `@bluesyoung/wechat-auth`

ğŸŒŸ å¾®ä¿¡ç½‘é¡µæˆæƒ/ç½‘é¡µåº”ç”¨ç™»å½•ï¼Œè·å–æˆæƒç 

### `@bluesyoung/call-app`

ğŸŒŸ åŸºäº `scheme` çš„æ‰‹æœºæµè§ˆå™¨å”¤ç«¯

### `@bluesyoung/qrcode-with-logo`

ğŸŒŸ ç»˜åˆ¶å¸¦æœ‰ `logo` çš„äºŒç»´ç 

ğŸŒŸ åœ¨ `qrcode-with-logos` ä¸Šè¿›è¡Œäº†éƒ¨åˆ†æ”¹è¿›

## æ—¥å¿—ç›¸å…³æ“ä½œ

### `consola`

ğŸŒŸ `nuxt` å‡ºå“

ğŸŒŸ æœåŠ¡ç«¯/æµè§ˆå™¨éƒ½å¯ä»¥ä½¿ç”¨

ğŸŒŸ å¯ä»¥ç›´æ¥å°†æ™®é€šçš„ `console` è¾“å‡ºç›´æ¥æ— æ„Ÿä»£ç†

```ts
// æµè§ˆå™¨
import consola, { LogLevel } from 'consola';
// æ„å»ºå®ä¾‹
const logger = consola.create({
  // æŒ‡å®šæ—¥å¿—è¾“å‡ºçš„ç­‰çº§ä¸º warn åŠæ›´åŠ ä¸¥é‡çš„ï¼Œä¸é…ç½®é»˜è®¤ä¸º info
  level: LogLevel.Warn,
});
// ä»£ç†å…¨å±€çš„ consoleï¼Œæ­¤åæ‰€æœ‰çš„è¾“å‡ºéƒ½ä¼šè¡¨ç°ä¸º consola è¾“å‡º
logger.wrapAll();
```

```ts
// æœåŠ¡ç«¯
import consola, { JSONReporter, BasicReporter, FancyReporter } from 'consola';
const logger = consola.create({
  reporters: [
    new BasicReporter(),
    new FancyReporter(),
    new JSONReporter()
  ],
  defaults: {
    tag: 'young',
    message: 'Aloha',
  }
});
logger.success('lalala');
/**
 * [success] [young] Aloha lalala
 * âˆš Aloha lalala
 * {"date":"2022-11-19T03:26:13.559Z","args":["Aloha","lalala"],"type":"success","level":3,"tag":"young"}
 */
```

### `log4js`

åªèƒ½åœ¨æœåŠ¡ç«¯ä½¿ç”¨

```ts
import Log from 'log4js';
import c from 'picocolors';

const { getLogger } = Log;

export const logger = getLogger('young');
logger.level = process.env.LOG_LEVEL;

export const logger_trace = (info: string = '') => logger.trace(c.inverse(c.bgBlue(info)));
export const logger_debug = (info: string = '') => logger.debug(c.inverse(c.bgCyan(info)));
export const logger_info = (info: string = '') => logger.info(c.inverse(c.bgGreen(info)));
export const logger_warn = (info: string = '') => logger.warn(c.inverse(c.bgYellow(info)));
export const logger_error = (info: string = '') => logger.error(c.inverse(c.bgRed(info)));
export const logger_fatal = (info: string = '') => logger.fatal(c.inverse(c.bgMagenta(info)));
```


## canvas æ“ä½œ

### `fabric`

**`@types/fabric` éœ€è¦ä¾èµ– `canvas` åŒ…ï¼ï¼ï¼**

<Alert type="warning">**`canvas` éœ€è¦ä» `github` æ‹‰å–ï¼Œå¦‚éå¿…è¦ï¼Œä¸å»ºè®®ä½¿ç”¨**</Alert>

```ts
import { fabric } from 'fabric';

// éœ€è¦ä¸äº¤äº’çš„ canvas æ—¶ä½¿ç”¨ï¼Œæœ‰äº¤äº’éœ€æ±‚ç›´æ¥å®ä¾‹åŒ– fabric.Canvas
const canvas = new fabric.StaticCanvas('poster', {
  width,
  height
});

// é¡¶éƒ¨é»‘è‰²èƒŒæ™¯
const top = new fabric.Rect({
  left: 0,
  top: 0,
  fill: 'black',
  width,
  height: topHeight
});
canvas.add(top);

// å›¾å½¢ç»˜åˆ¶
const icon = new Image();
// å¦‚æœå›¾ç‰‡è·¨åŸŸï¼Œåˆ™éœ€è¦ä»¥ä¸‹ä¸¤ä¸ªå±æ€§ï¼Œå¦åˆ™æ— æ³•æ­£å¸¸å¯¼å‡º
// å¦‚æœå…ˆå‰ä½¿ç”¨ img æ ‡ç­¾è·å–è¿‡è¯¥å›¾ç‰‡ï¼Œåˆ™ img æ ‡ç­¾ä¹Ÿå¿…é¡»å¸¦æœ‰ anonymous å±æ€§ï¼Œå¦åˆ™ä¼šå¯¼è‡´ç¬¬äºŒæ¬¡è·å–ä¸åˆ°ï¼ï¼ï¼
icon.crossOrigin = 'anonymous';
icon.referrerPolicy = 'no-referrer';

icon.src = 'å›¾ç‰‡åœ°å€';
icon.onload = () => {
  const oImg = new fabric.Image(icon);
  // å°†å›¾ç‰‡ç¼©æ”¾åˆ°æŒ‡å®šçš„å®½é«˜
  oImg.scaleToHeight(iconWidth);
  oImg.scaleToWidth(iconWidth);

  oImg.left = width / 5 * 2;
  oImg.top = (topHeight - iconWidth) / 2;

  canvas.add(oImg);
};
```